using Datagrammer.Quic.Protocol.Tls;
using System;
using System.Text;
using Xunit;

namespace Tests.Tls
{
    public class SignatureSchemeCertificateTests
    {
        [Fact]
        public void CreatePublicCertificate_FromPfx_RSA_PKCS1_SHA256_ResultIsExpected()
        {
            //Arrange
            var pfxData = GetPfxCertificateHexData();
            var expectedData = GetPublicCertificateHexData();

            using var privateCertificate = SignatureScheme.RSA_PKCS1_SHA256.CreatePrivateCertificatePfx(Utils.ParseHexString(pfxData.Hex), pfxData.Password);

            //Act
            var buffer = new byte[TlsBuffer.MaxRecordSize];
            var cursor = buffer.AsSpan();

            privateCertificate.WritePublic(ref cursor);

            Array.Resize(ref buffer, buffer.Length - cursor.Length);

            //Assert
            Assert.Equal(expectedData, Utils.ToHexString(buffer), true);
        }

        [Fact]
        public void SignHash_FromPfx_RSA_PKCS1_SHA256_ResultIsExpected()
        {
            //Arrange
            var pfxData = GetPfxCertificateHexData();
            var signatureData = GetSignatureHexData();
            var dataToSign = GetContentBytes();

            var hash = SignatureScheme.RSA_PKCS1_SHA256.GetHash();
            using var privateCertificate = SignatureScheme.RSA_PKCS1_SHA256.CreatePrivateCertificatePfx(Utils.ParseHexString(pfxData.Hex), pfxData.Password);

            //Act
            var buffer = new byte[TlsBuffer.MaxRecordSize];
            var cursor = buffer.AsSpan();
            var hashToSign = hash.CreateHash(dataToSign).ToArray();

            privateCertificate.SignHash(hashToSign, ref cursor);

            Array.Resize(ref buffer, buffer.Length - cursor.Length);

            //Assert
            Assert.Equal(signatureData, Utils.ToHexString(buffer), true);
        }

        [Fact]
        public void VerifyHash_RSA_PKCS1_SHA256_True()
        {
            //Arrange
            var certificateData = GetPublicCertificateHexData();
            var signatureData = GetSignatureHexData();
            var dataToSign = GetContentBytes();

            var hash = SignatureScheme.RSA_PKCS1_SHA256.GetHash();
            using var publicCertificate = SignatureScheme.RSA_PKCS1_SHA256.CreatePublicCertificate(Utils.ParseHexString(certificateData));

            //Act
            var hashToVerify = hash.CreateHash(dataToSign).ToArray();
            var result = publicCertificate.VerifyHash(hashToVerify, Utils.ParseHexString(signatureData));

            //Assert
            Assert.True(result);
        }

        private (string Hex, string Password) GetPfxCertificateHexData()
        {
            return ("308217510201033082171706092A864886F70D010701A0821708048217043082170030820D3706092A864886F70D010706A0820D2830820D2402010030820D1D06092A864886F70D010701301C060A2A864886F70D010C0106300E0408B42951EE8369B5E60202080080820CF0FA536E74087A190F77DB358E4D84361242287C50BDA5A347BC8664B478079EB798070B3BC18DEB1910A2733EB485CCF9F970523CEF54E10FBD3C3E1D11CA171E3A9F9E46DAE4A2B1C5B04E23C181F145059CF74541F2DFE18A70B61FF00E911F1BC35C3BF41279EDCFB84AEDC7535E3712DA6AE04E4DDFA4E6EF34A229734283CBF7FB4F4AC854DF74F033254C602E1056554C4F176A1E220669890C36084FC5DF362825F7EFDDA5A80AF349BC8B91AF6C47BEB8B3368FAC73EA4C22DF26A2C322C48F371BB13D4913FF18EC40C8847414D6B02918EF8EE84BA9F93C13E148C2158CDF92709995233AD0F6AD3C79CD305BC4B5FDB08F2AD7D2F7714C5B637E8341C8EC64B7499F692F4AA5B7925A47B101D36AD49685AFC5DB00423EAEFF393D3B1798664D456100D334E54AEFE3C184323E793FD8FDB138B272AE486115638CD14312076B5CE1EB10139168DC37629AF3B8BF4C244CC91B84D386A92ABD9B6FEFDF156F46362BF9F773EE720381870D6B9347F158A36E587A2C037E74FD5465C0C55A40CDC9964D8A1BD4AE909F47BFB57876C6371F614EA706249915F333A61A05A9E6E09396864F2DA80101B88A1CF32A68FD47995849879AD85F766FBE06D829F9CC33D4968F3ED2BF1E57EC08F9DACD0FCA18CAF4CCBA64F11DD8D02887E0B5D2FFD8DEFE352E609FA24B8D7E67F96A02A72EFB490F61AACC6CF942225C4A99BB29B4C48DA60B536A7C934815851D21153CE9C47E1D8BEDD5475F5C9179A3313730A63F324D84D0F941A44F06167349F8F10884EB9F2196C6ADD7400FB75F2B4B2F249F2637DDEC01CC1A5B3A19AF086414EFD102BD27C6AA7BD9CAC8DDF6422A04D5025F7415E7B40F005C356583E2E6C40DB7990B184B61043FDB572334737DE893637F725D2C2EFD457FA29BE837CD6295BB06F663E62983E4389B6C979595CAD3323D6B5A344550D5891EFF3F68377362FA2A97B54185847361F6A97D2F054BC93834689E7F9D62D34DDE54FAE5FABD947FFBBB1EF3BA469CC4181BB81F927A1A3BEC855EACC6342BF8AE888E2169BA11719D4E7BF1BA8453C156762855A7BA8BBCFEF032E6E8FCB7659B84654F81A19322D237F192C22D5F778AC5D0D57D6FAE6173EDE83A7DDFAFB6C4AA97ABA1089AA267DB3A630FEC93AA199F250BAA82622E17B3D57F0BE68B5B0BBC640A5F457BF878A6FC77CE411EFDE8899F365FD28DE374220B831159B34AE544AD1F7544A98010855B963B67AFA3C2B49B7FA36E3D31893E9D24B48C8B80C3E34E2582713E7BDAEE5C3752BFCE4011B5E3FBD8675BBB2E0FC8390BE81EA2B59357752BA63BC44905317E29E24A1E5CD9722502158294E3A708CAEEA5B3C1B643F94FBA501AD0CC915D6AD80FF5D1C468AD7E32CE6122F265978DEE68294C13F26C4AE9ED298323D5A7C541FF8F1C83AC87E27EDA365C1CF6EC265C325A3241A50F74CB8C0249920B25D24061CFD3AAC949471048E3F072F34506CF61D8A05A2519BF72AED7393F1E524BD2EBA0FB676A747A8270CB0ADD91AAC2BC1BECB2F726840BF1E8645455B89EDF346FCDD0201176C1567DFE4628CAD844FBE4ABFEBEA7ABC41EFA88FF63D81D33A97D68C61E2ACF4ECD234EB8A72B5B0F2AF14C2448D51DE78ACE31F3D51DA6E8FA31A4B20ECFB02523B11E9696EC1C13AB33BE9A0E67E1DF135D23DCE241D7F0C757AE32A34CBEEE248C5B3FF7CC2A4555112C5B1BB83D472785FEA4CA79F7939193CE5848E8FA7035818859F4C0370E60FC460971A83CD192B5A5E4BCBB1B7927C4B3F657FDEC774EC9034621DEB37087BB804CBBC4116E63273B83EC96436EB9B55AC4CC36E690CF85DDDF13269CE342C54646648EAD8CB9D83FCCD7171EE0D7D2EE031D2A1EEC2415B60FF414200C724195F9F1BFFF296541CBF78F802D825F8B1730EB1B4D5AD065C7DFE252E4751838D14DD1FD0248E509732FDE3A9C14FBF359D3B9822787ACFFDF9DEC860E2C07490B3EDF82CCFFA598032548D02F5B26B3705025B7CB4EA3A618C4C71B8BDBA265D604D1BD506D6692130DD0BFE9B69ABAF0F26DE08024DDBDE22026DB7B2B4A095736EE47E5DB7614412E655BD81B64D704E35C216640D8D21599C8EED54497B010E997DBE1089D142D5BB703A8062E086A0F29418C4BD7C6FCDEC2B8AAC5918C967E06055306A66D619B2551D803DD8AD1931F7AC157BA692C0015A77EC2598F1BF52E556F77BCF76BA5EDAE66E70A6C9A6BE461EC44510E76C96DAF804A0C63446F540C6A83D0466774DACCD081BAB0D5203646C94D778F4DCFFA0A8614797EF3A5A059A3DCC00A16846EFA44A494F2E0F2B7E518200594AC2F5972A64A502374CED2812948A8FF7678D6E2508893BF690AEF86400FFCDC84AC402387565561EF1EC8FF9FD2B500A4FAE8160F540B42DC3B3F531C46219E6AC4C4D5F1916DEEFF4DC49F75BCE0770DD0D6110FE8DE6C0F91FC1EB90CD2D7F66E01234B24D5F4C9F6FC5A9A5C066B35E0C3B4193EC0625C6BC5B066EF0F5CAD37257037F613CD37BAF9B68A8173CD3DEC409DC9F4508A519FB1D17B4DB826993A867E1DEA9CC83FB2C85589F2AA1372EF9077B1FEA89105508299D9904AEE3C2E1CDE7DBEA2E3F48F84AF44A5112FC2BE86B1BF94B76D27EEF8DDBACAD95E8F00E18BA1679EB97EE4926E76DA752FFF61D7438005CC13843669F874BE9C16F1248E00C894BDFA19BF386539EC3671FA884648E72AC2DDE601288CD7F7FB9F6B039F858391105C30389AED3F1BDE4BF8ACED22F84CD5F89A1A37EE4FDD2E4A414B39AA298203E2B033374AB2A5B6CCF8E3C3E775237C9A0EAC6B8541E0FF576FFD9DBE09059121A6F7D05C7BCDEC94853F22444F0DDB781F0E0EA36B1E16D069DB6376252CF7DCE3C73FC7C9AE66460236A36687C2EC7ABF1028D3A1DACEB2FF9BB07218524A023762E5C352B059AEA8611AF394BF51EFF1944D3A9E56369657566490026736ED1F7BD59FF5B80FA0E36C5094D154ADC1E05D73D5E82CC4DA01C5700F89E63383751B81D46823C36EFA24C9BE27FB6669F37FA1B8BAB88C8778E6068805A2002315F5956E0F6CB98BF3D5FF40F31A58B33BEEDF050F58AA8FB4ECEC842767A5B732005D6C74CF8F6B4405381C9E38F38F0443D6BE8CF5B7C3E3FFF01D08AD93E112AFF90F1D85FB7B1A0B3640E58D7FDBF83DF404B3F67AE57539128D491BA98D7BD8C37EC148F5D61D7E01E7112E93BA6439973ECD030332CA65B9E5B4A38A35A5B0F9D94DE42219B0483B53B3AA75AA3727316AA076284FABD91535E09FAF431636ECB6F779C56A1AEC60CFD6982AC8A5DD0308F1D1192B1C23BB4268CDDA9F2DAAF4B2B922CAB000C5D83424F3A9FE7128CB3CF9E6237C5BD4D08F83FFAF50E963B2CF2F5ED5B68C7E5869291B0FA8712CDBD960FF8A8BE80FC08188FAAED59CDFA7D5A6514AAC7EB5401EB8D3921F9BB45FD8E92F1CDB3256B9472FCD945B9BCF432550270528B2CE7BBE5EA8D53EC6757162ADBD33FAF45B59E2DADB2E0F4D07B12E87E13739B74C84728DA517C2F4B6F3ABBD00FE344710FC391AEACB1E02FCC2C7B90C2DF87016A84C796DC225465137E86E02BFE1722321CD89998944C696C4FB3D613D6961234FB1ED2A5DC8D546FA713F600AD223CC364E53686940BB77FA180E5EE83A172AB5674C1422DA83AEC2C28653D325EC5510CC5F7DB1421DA5C4E34A0063D55EA7ED186DFB827039A601D95800A312E48F96E8B68F62E0E1ED7FC421E64107CA8557960002667CB2B54DB0284D063FF2569C73B02D331F2E201FA10EA3DD8F48022B7355BEA2A8A5BAE3DDFF5A624E45E4C0D8EA587895A36319CDC0DF214ED3A507319663BA8793DC5EB612E83ACC1E0745CF15A0DAAE3FFB27DF68D2C550E7E258464B14E54BEF3DCC27EF1D2954BCF034A4C4912CD09F60FC7398D59E9BA0FD4B35CC9118D1012E192274BA591A119E1B19F2C7CD8CF177C5801DA06210FDFB73DEB09C26CF7CD5A65A807216AE05954A6578628E9A00953B7C457257F896D979D7F8DB99022EF181B4B638ECB0F982AADF1AA0B491EDAF1F05E888B342C59EF97D8526A69EFEDB8B13FBA3B46AEE168015E64BFA2804C74437362ECB67C7DB87A7880A03AD818190EDD762344A4F9FF44337386BD1600E135CC24475F6406DF812861B7240DC7A2BE245EEBE27884610B42B8B02DB49F674B1308EE09E7FBDAFD8D8BF30141EA23A9F84CFF4CBE560E1B136684099CCC4838935DA1177D0CDFF540A9AD589EC1A5E7F7AE746453D491102F5B2D77F87020D0AAD64515F542FC8BCF3FAB82811153721BC29A3BF2C6E4C7A2023B8A2B7DF190CEDB1EEE3A8BC46F72998DE235FDABD3ABFC44A12F5C4C879AB451EF703B28E75A564AD80B6415427B0A61AE348918BFC6CDEDDEB0EB93E0E5158D367F470139DC2315A73D78D0E9149672981F318A1A6508FCC7F8C5770981F6A10A75B5D926FF7424C596B447453A5F972648F7400D95B5EB472969DE1C012479EF0410056BA26EA67D01DF2D596B9B9149E9318C418FA6F88698866B59250C97FDD2A29CB037F6B8EA9F516AAA7FFF776D1155BA7716459D735CC06D22B1A27BBCCEC79B452193BC785E5FACBD5B8E9D3E3352EE42BC46FE438D9547EEEA25128B889E42B9C308209C106092A864886F70D010701A08209B2048209AE308209AA308209A6060B2A864886F70D010C0A0102A082096E3082096A301C060A2A864886F70D010C0103300E0408BAABC12875079B3F020208000482094832CBB02888069E28A766641EC8C1FD840BA857316027A2F1C1BE09C1D3DE296742294277651FC072065FA8999B865305EFD1A10A6EEA20664890561E01EAD27456CFDFADF42EC6FC94688248C22E0C46CAD5FF59C0E6B1DA499EFAC745C96925F51CB2450E00AD82FBE759636355F3E5C6720D43469994270BA089208603AF35CBB775FFE589CEE4C38198E060E36200A12912DFFC52B03014955EE9DD51915826B41AF87B19B82CCE2FE53335390179966F3AB068C9E1B71EEAB7A9F06E2FA6B1FD733EE0CFE5F1168050B9F988AED597E2413C7172814BD05B5B585EFE780D5D14E9AD36A400009A12B579924F41E46F5C615E99AF70EB71C640D55FB4719059079142364BFEEC8649C86B0E571D437F6A94BD47B5B1A338C784FF10FDA57FF3708B2323A580D1452ED82A011D81DFF290712BDB5B9A63BA102429F0CF82A9A394CF8A405A5246517626EBC8B058FAAEDFB30062FAAC22DDA671B039F1810258FF48B3AF2D5EACD5D2D87B6D9AC6FC81EA37A633998B6094CFB0EF68CBDD5C024F4DC2B4C9C6E217E8FDC50A98B48E0A791C65783F17B1FD10D2F9F1647F0B986C1B8938CFA24C5A27C5883A220A60D88D9A6C09706BBAA84E8E0589E7A7B6A865D6B6D96A43E3D0F6F82E03C3543ADA3E3D8B7F9E17111C051255C781F70282552F365920ED405828555757FFF151BE7A8E01BADD0E8505E6B2F6C7BED67213A27F6B0161AD15B038A7C319ECBA59F583EC35A4B7844B14E3BFC86B73BA1F0EE27C77ABF4594B1D189CA61159DD71A278A7B3C7B6826568160A5C3CF128D89B9E89469B6B9098F36438777A8EFA18C4636BCDFD7D2A08577EEB4608CE9307AB62D2F12B330FEFE1028FA76AD06E9DF6FC441AC84E3A60BFA85F434A8C4F9E302778CCB46B705A0C2506DD7EB756CD3968EB5FC334C1105AFCA434350281F9A4E2469E196CED740FA4EE1A3BF6ACDA53103BBC53E040CA2FA9773A3A23C2568ACB2A768485C6161230657DCA2605C4A42B1D922D93605CA4CE118728DFE4FDA265CA1B3409D90065772F168A1809A1619E4E1610CE7EF2D27012892259424D637F764850072E72D5CFD3BE2BF2E2F5A9E57BC1CBDB62C0A9C0E726CC1A3032D896B1EBBDA27C378E1881204D6A953DECD10136AADA937AC952F822970D25641C5E4D3AAF6989D7486E2EC19CC43D51F5D48180C698E469ABAF26E6BD33BD874C1EAC6527B7C3F222A0B350E7E7E43FFB7D703361A903BDE29A18AA86E7E75883E87F2B4F7C5ADA30D98A9F135B8DED19FE1806E097852198A0E7429F096B3CBA1FE0469FFFC361A2BDBA6B38CE31B0B8077B89AF334871A86CF7DC8D2B906EAEF4E2EA7207B55639D22EFCFD1571DB7CFED67DA74EE06602475D25FD441ACCDED82881FFFA846DDE1B3DF5AFB5658D0516F2F9D44680031579FF3BC6F152F3CE4BD0D0B5627CE3A2E46E0EF42CEF4699D788DECAE4346B660B9CA1C86B4C64E80B4809B8D145789E661492D9E895CF182A6CE7DCBB3F1276C61A1A64DB9CB35FCCF6BF75DC25CF271E23B341B28BED2862758FBF9120B9FA4341382FDC82D99D2028A4740030403B433E9840783A907582D52759D7B6D9AA292740CEB93CAA272547A9410A0DC7A2BD4F44A47CD3EB0137B881F263B143E7E90B608C48070FDACC59790C5AB0A60EBFF736BAD7F41C490A3C8EAE285F43ED62159E36C699D7E705F4098BD07D87C23623145128E83CA5F16695CD00FD0089409A4B2997F36274A5C88BC2E8BF0773FC904C342F6DFC89547B88F7F8F70573CDE7DFACEC7B8FFED3D6928597E2B99327AC26A30CA6225C06817CC3463E88C98E60348724E4434C5DFB00594764BB986EAE086C67F70175995C58F0858E4B4372FB398EC59C65D24C13921FEF0A5D67298F3A24CA23D0AB2E9F02BCD5B37811BF78E361EA39E1416ED0C967CDF9F166E7A377BA3A2FAB25C140C6CE282BBA28B1D1D901E4A3D33E11CCC1B986C27F38DD549EC7C62D769B213634DDE82119CAE4EACA6B73E6B2062D9778EAB35C5334D16E015ADF13CBB5B89F3D433CD4F2AB92530DBF9181071FDDD2E493903EB6336B7E6B171D2071C15F50B41A9D36AD4F944755F8AF0BF8A62CB57C5DC6DBFA05B05A48B2B64E12207365FB4653BCA1531677F38BAF2C00E19B6598E88521298589240EC2DC64D1E8953E3C7337938D60F04E095F7C34398FC34AE43379793EEC842DA489B1DB4D8DDA4D824C1274BF6C8F73D205CFB96F3BD4EAD3821723C6243F4B91056378F3857AD507968E5F6D8B7B31A3C59D0CA354FDF862BD32DD365F1C55BDA25B5FD309291034A076DDD71C9065F1783DBA564BCEC3F124558EB2BEE18AEAA62D12ED7219A806EEB8CD5CEE0346E37F773C82AA30026768649FD0D2BD9BF2094BF98B554E4D4F30F9B1FD2A359890B78D3BBD75EA63FA5512CADFC5EF63D84A5F901F03387CA664802743BBC4540E838A26D03DEDB5FA1B81138F068C1F6C7DB3A723B2FB714FE38E8C1F0B5D042C7D783369488B0B8531CE8419FFA9A1A6219047FDCF8750089CD0C4EE3844A8D7483ECC63C653F9E0554569BE9E22ACE9B25CEE7CD9D839BA1F425CC8BD81DB85286B88C2BA3A5CB3C5B0BE1E3A4C30B90D5D155CDC758A96D113CDA36A8E72D4B27BE5E9CAFF0090207F319439A0B1AE67B822CD19B50D6BCAF87B0181F0435E850C1E2BB42C5E6099D86619B801C8E5B44F09344B05120F2C90D575A87F524BD75EF25CB4629F52F9FE84D2B5C698C49840AA8E3BE5F620D879F6874C3D91DBAD8D0168460247979DD0864FC12E15A0D846E3116E7B74E49EE78072CFEEC1BDF92663EAA70A61EF822274F6F56A9267EA65CE1988F959CE7F10373370ED57216CDC3DADE49905ED68D4908B191A42C89CBFE77799D7D34DF7F4C18772A0E37F28C82A07CED1786AB4A23F5644C00C892E9937AFD6E413F397F21AFF038E6480EE781AB3B6C827F3CC73FE6A61DF6577A6A013908CC7B2FFEC82306E5175E4C5BEA830DF8C3D0D209AA1C4DDAE177698B94F242FD5BE498573BCBE40A6E595814552E07ABE813CD8CC549E758261F2D09B77BCF1287DFF686B322BD381098CC2C14E95B744A10916C6110D7E1981186958DE233B3F6DB5F4A3DC0626D59645FC4AF85E482678738A47117DAFED67BB77BBFDBEBF76075C68B604FA5E0B487D9BDA3FB955A0D70DBFEB63206441CE1C42AD9FACF0CBDB1A71819671A64FCA816AE786F17A6112429823758703B19D4C4C3897BF4D1D9029CDAE9CA315ED14060C3AF7ECE283772952487E0BE30F6D1E8A9AE91F897A587579C1998CEC9B81C5D307F91E469D8313356A41DB303125302306092A864886F70D01091531160414921B97842F23474D8961BFD54911C298316AA55830313021300906052B0E03021A0500041435EA6373596F3F5001694D5FE14338C17886830804087403E34709F5A7F902020800", "1234");
        }

        private string GetPublicCertificateHexData()
        {
            return "308206253082040DA003020102020102300D06092A864886F70D01010505003081B2310B3009060355040613024652310F300D06035504080C06416C736163653113301106035504070C0A5374726173626F75726731183016060355040A0C0F7777772E667265656C616E2E6F72673110300E060355040B0C07667265656C616E312D302B06035504030C24467265656C616E2053616D706C6520436572746966696361746520417574686F726974793122302006092A864886F70D0109011613636F6E7461637440667265656C616E2E6F7267301E170D3132303432373130353434305A170D3232303432353130353434305A307C310B3009060355040613024652310F300D06035504080C06416C7361636531183016060355040A0C0F7777772E667265656C616E2E6F72673110300E060355040B0C07667265656C616E310C300A06035504030C03626F623122302006092A864886F70D0109011613636F6E7461637440667265656C616E2E6F726730820222300D06092A864886F70D01010105000382020F003082020A0282020100C23F43144AD4DD435AB9435E2DBB89A11718F7AE474B7AF4D4DCA3E1B7853A1020EBBC5118D88B25C604954F80E9055C00F47C237BD1AD8158F19D43C337EE7F6103B5FF29BB101AFBA877979BDE4C7D3FCAFF538C3730B688F20EBE7CDC9276C95F2296190B91EA9C18969F43D19D229ED9C3129F8005851F70BB875D63C15A513D7E693D766DB056EADB3FAEF0CD0C1948B1F2D52EE7FA12DD15BC8CDC09C2269CDC22528EC81CC1CD01BD1A24C5BE4F1808F3DE591C8F63A6631D4F5A92687A49942654D183BE16E45E8F732F813A3A3080FD57A97F1B7BE50F6C0168F71F4549FE063C08576427A50B5518B730BE0845708BCD43EAFC801E035CC3528DA9555355F4612E8B50646A30A76FBDB88012EE6698D8785FA0F5656A6DF509CC624D555680217548734DB9E3F91D96C92C5D794D3CC57A9E84FF9DC794870A3E6981D27FC05F679C068C335CA39F52E704C7D381EFB2771ED0571F1F90A569C00D43C5F6A67EF7EA457C60B6681F6459DC6033C2138CB706C22ACDCC2B02DEA2E9700CDB79FECEEB5EC006EB764309E02AC7EE1E6AAF6049733CA8538CE1392CE79EFEFD4420F0859A1FEBC740C85B9043E6A16A00504B737372C53977131E3C95BEA9376AD14E343D34EC87F81E6CE7DC8B7F8ED13C78C2E20993D7C068AE7081B9F0D0F726A4E2C0121D2F0163EB5305CBAADB66B0FB169BE7E7BEC366DA5CC90203010001A37B307930090603551D1304023000302C06096086480186F842010D041F161D4F70656E53534C2047656E657261746564204365727469666963617465301D0603551D0E041604149CD2715035F71043DDE8CE7529A3535D11A7A83B301F0603551D23041830168014236C2D3D3E295D78B86C3EAAE2BB2E1E6C87F253300D06092A864886F70D01010505000382020100C3B0A482F564E54EA0E5745EC43DD09CF74EF78DAF8B2E805963B56E2F105B66D6292ACAE2012068E12BFFD6E1E1F2A6E0CCF58F9F5C72B8FA81767D5CEE6029E5D7DE8F4A9C553EE5271C76BC35E716806F3277FD57AE5187FBBEC2A1CC769A6101C9FF8600FFD196CDFF2C0F489EAE83D8DFD4781D4C3787F5585D26C6CA16CDFA161D6F42AE574A994552805C1C7642A8F8F3159C1B3E3601E0095ED819B1EDA0EF3BC709A7AA5FB62DC120849B2C871A2B35DE9E9C0CD90C5ECF5138D6D680AE9115B5C622DF7E179FC3EBBFFDD53B4BEA660072A0B5B765A85AD9A8F167C141D879DDCC2F787A9E5E0A9D770E595249D210941CEBF43C040E3C1C1A75A6E823D5F0731490B1715A32578D34D76A61DC731ADA1D1F56A72EEF0DA4F5FB940BF4CF1DD2100F07CDBA9D7887E804636AE57A6B20BDBD29C2395BFC8684770BE3F82C37ACAF1BED4FB9D608A3AC2F31074AF88ECF11DD921CC9AAC7A5B762A4776E58207817CB5EEF6D41EBB6C21F7FA1DEFABB719220DEB15E34846CED6CE1438613F03FD72DC5BAC0DE378D48BCDFC74FB3A6A5E5C2DBF1EFDB0C2569E6588DBA72BD5E3FCF8136B6ABEEA8678FEEBBFE6FC91F8A1FEFE9C97A5240ADA03F23457A6395983D12B8E2F30B8810380468B0F1A78BD061D70F2FCF175121EB76692D19E801C533FD61CD4664878943E931D0BE88A0A2820C7F9F66413A9A5A6A";
        }

        public string GetSignatureHexData()
        {
            return "171F00E23150ACC17270B3D517F0388E3E3D302F898AD5502D68BE842C1135C7F4293937434B59EA88C758A36C441CA153E3BB985A03AE73B42D5F12F9432E1B2B48F93B6B76C3852A98A665BF595B2A3E3320730BAAC6E03E46D4B34E4C0FD3ED99D6FA7F6ECAEE5D78A67DD0973B28F536DDF203106ABA7CBBE6AC4AEAA5C8B626C2AD2EA34D8D4F7F10B6632AA801DB9D4131139478977C76C98DB1083368F167A4BC046EC13ED3B8735328860DB4B4659BAEF0CC47738D3A611FFFD0020ECA62A6B6EB58E20D5A9F38D6DBB01B78311C52A82D125791A4F2293BFC939FE1309A9ED5EFA8897A69965065DDAF7A4E717538E9F28A267EDFA697D421A3FD6AF43A34DD6B1EDFD15DF94AAF2EF24D60BBB83FF41077E2D14C6D2ADEFFFD9B66377160F72CD9C4D07CB904A8A8BD0873636C0634CB9D967DECEE65EBCD7F5A023C1E8BB68E692289406B7C54B06354F71EAB4904B5B1009CF125048BFBEB419F00A25F5F8CCAB2B131CE686F2F463EA0371477586489AC7C4A2640F602D662D08103D9E8ADDAA05DE0919FE792B597F1CC48C67FB47E61F2B2F17E2544CCAE832D188D96BE1078E6B92F846DA277DB3ABCF85F69E4D179C1819CC1F6C36219E0C8CD5E1A56D77219DB5449A02FFB6A0A80377818BEB907CC1A336557DF2CEE0C2743898F1E615E7D9DD4C94E19862B2401EA4DD67A27C45B8C98FF9071EB89B3";
        }

        public byte[] GetContentBytes()
        {
            return Encoding.UTF8.GetBytes("test text to hash");
        }
    }
}
